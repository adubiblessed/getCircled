{% extends 'mainusers/base.html' %}

{% block content %}

<div class="max-w-4xl mx-auto">
    <!-- Profile Card -->
    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
        <!-- Header Section -->
        <div class="bg-gradient-to-r from-blue-primary to-blue-medium h-32"></div>
        
        <!-- Profile Info -->
        <div class="px-6 md:px-8 pb-8">
            <!-- Avatar -->
            <div class="flex items-end -mt-16 mb-6">
                <div class="w-32 h-32 bg-white rounded-full border-4 border-white shadow-lg flex items-center justify-center">
                    <svg class="w-20 h-20 text-blue-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                </div>
            </div>

            <!-- User Details -->
            <div class="space-y-4">
                <div>
                    <h1 class="text-3xl font-bold text-blue-dark mb-1">{{ profile.username }}</h1>
                    <p class="text-gray-500 text-sm">{{ profile.user.email }}</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 pt-4">
                    <div class="bg-blue-lightest rounded-lg p-4">
                        <p class="text-xs text-gray-500 uppercase tracking-wide mb-1">First Name</p>
                        <p class="text-gray-800 font-medium">{{ profile.user.first_name }}</p>
                    </div>
                    
                    <div class="bg-blue-lightest rounded-lg p-4">
                        <p class="text-xs text-gray-500 uppercase tracking-wide mb-1">Last Name</p>
                        <p class="text-gray-800 font-medium">{{ profile.user.last_name }}</p>
                    </div>
                </div>

                {% if profile.user.bio %}
                <div class="bg-blue-lightest rounded-lg p-4">
                    <p class="text-xs text-gray-500 uppercase tracking-wide mb-2">Bio</p>
                    <p class="text-gray-700 leading-relaxed">{{ profile.user.bio }}</p>
                </div>
                {% endif %}

                <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
    <h2 class="text-2xl font-bold text-blue-dark mb-6">QR Code</h2>
    
    {% if profile.qr_code %}
        <div class="flex flex-col items-center space-y-6">
            <!-- QR Code Image -->
            <div class="bg-blue-lightest p-6 rounded-lg border-2 border-blue-light">
                <img src="{{ profile.qr_code.qr_code_image.url }}" 
                     alt="QR Code" 
                     class="w-64 h-64 object-contain">
            </div>
            
            <!-- Download Button -->
            <a href="{{ profile.qr_code.qr_code_image.url }}" 
               download 
               class="bg-blue-primary text-white px-6 py-3 rounded font-semibold hover:bg-blue-dark transition-colors duration-200 flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                </svg>
                Download QR Code
            </a>
          </div>
          {% else %}
              <div class="text-center py-12">
                  <svg class="w-16 h-16 mx-auto mb-4 text-blue-light" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"></path>
                  </svg>
                  <p class="text-gray-400 text-sm">No QR code yet.</p>
              </div>
          {% endif %}
          </div>

                <!-- Connection Action -->
                {% if profile.user != request.user %}
                <div class="pt-4 border-t border-gray-200">
                    <form method="POST">
                        {% csrf_token %}
                        {% if connection_status == "none" %}
                            <button type="submit" class="w-full md:w-auto bg-blue-primary text-white px-6 py-3 rounded font-semibold hover:bg-blue-dark transition-colors duration-200">
                                Connect
                            </button>
                        {% elif connection_status == "pending" %}
                            <button type="button" class="w-full md:w-auto bg-blue-light text-blue-dark px-6 py-3 rounded font-semibold cursor-not-allowed" disabled>
                                Request Sent
                            </button>
                        {% elif connection_status == "accepted" %}
                            <button type="button" class="w-full md:w-auto bg-blue-medium text-white px-6 py-3 rounded font-semibold cursor-not-allowed flex items-center justify-center gap-2" disabled>
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Connected
                            </button>
                        {% endif %}
                    </form>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% endblock %}